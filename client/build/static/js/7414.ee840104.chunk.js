"use strict";(self.webpackChunkfresh_app=self.webpackChunkfresh_app||[]).push([[7414],{916:function(e,t,a){a.d(t,{op:function(){return d},sW:function(){return l},tb:function(){return o},wS:function(){return i}});var n=a(4165),r=a(5861),s=a(7218),u=s.E.injectEndpoints({endpoints:function(e){return{leaveList:e.query({query:function(){return{url:"leave/leaveList",method:"GET"}}}),leaveCreate:e.mutation({query:function(e){return{url:"leave/leaveCreate",method:"POST",body:e}},onQueryStarted:function(e,t){return(0,r.Z)((0,n.Z)().mark((function e(){var a,r,u,d;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.dispatch,r=t.queryFulfilled,e.prev=1,e.next=4,r;case 4:u=e.sent,d=u.data,a(s.E.util.updateQueryData("leaveList",void 0,(function(e){e.data.push(d.data)}))),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:case"end":return e.stop()}}),e,null,[[1,9]])})))()}}),leaveUpdate:e.mutation({query:function(e){var t=e.id,a=e.postBody;return{url:"leave/leaveUpdate/".concat(t),method:"PATCH",body:a}},onQueryStarted:function(e,t){return(0,r.Z)((0,n.Z)().mark((function a(){var r,u,d,i,o;return(0,n.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=e.id,e.postBody,u=t.dispatch,d=t.queryFulfilled,a.prev=2,a.next=5,d;case 5:i=a.sent,o=i.data,u(s.E.util.updateQueryData("leaveList",void 0,(function(e){var t,a,n,s,u,d,i,l=e.data.findIndex((function(e){return e.id===r}));e.data[l].duration=null===o||void 0===o||null===(t=o.data)||void 0===t?void 0:t.duration,e.data[l].endDate=null===o||void 0===o||null===(a=o.data)||void 0===a?void 0:a.endDate,e.data[l].reason=null===o||void 0===o||null===(n=o.data)||void 0===n?void 0:n.reason,e.data[l].startDate=null===o||void 0===o||null===(s=o.data)||void 0===s?void 0:s.startDate,e.data[l].status=null===o||void 0===o||null===(u=o.data)||void 0===u?void 0:u.status,e.data[l].studentID=null===o||void 0===o||null===(d=o.data)||void 0===d?void 0:d.studentID,e.data[l].subject=null===o||void 0===o||null===(i=o.data)||void 0===i?void 0:i.subject}))),a.next=12;break;case 10:a.prev=10,a.t0=a.catch(2);case 12:case"end":return a.stop()}}),a,null,[[2,10]])})))()}}),leaveDelete:e.mutation({query:function(e){return{url:"leave/leaveDelete/".concat(e),method:"DELETE"}},onQueryStarted:function(e,t){return(0,r.Z)((0,n.Z)().mark((function a(){var r,u,d;return(0,n.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return r=t.dispatch,u=t.queryFulfilled,d=r(s.E.util.updateQueryData("leaveList",void 0,(function(t){t.data=t.data.filter((function(t){return t.id!==e}))}))),a.prev=2,a.next=5,u;case 5:a.next=10;break;case 7:a.prev=7,a.t0=a.catch(2),d.undo();case 10:case"end":return a.stop()}}),a,null,[[2,7]])})))()}})}}}),d=u.useLeaveCreateMutation,i=u.useLeaveListQuery,o=u.useLeaveUpdateMutation,l=u.useLeaveDeleteMutation},7414:function(e,t,a){a.r(t);var n=a(9439),r=a(2791),s=a(7689),u=a(7022),d=a(9140),i=a(9743),o=a(2677),l=a(5630),c=a(3360),v=a(4849),f=a(9230),h=a(1134),x=a(4695),m=a(8007),j=a(1724),p=a(916),Z=a(1239),b=a(184);t.default=function(){var e=(0,r.useState)(null),t=(0,n.Z)(e,2),a=t[0],D=t[1],g=(0,r.useState)({startDate:(0,Z.p6)(new Date),endDate:(0,Z.p6)((new Date).setDate((new Date).getDate()+1)),duration:1,subject:"",reason:""}),y=(0,n.Z)(g,2),C=y[0],L=y[1],w=(0,f.$G)().t,q=(0,s.s0)(),I=(0,p.wS)().data,S=(0,p.op)(),E=(0,n.Z)(S,2),N=E[0],Q=E[1],T=Q.isLoading,k=Q.isSuccess,B=(0,p.tb)(),z=(0,n.Z)(B,2),G=z[0],M=z[1],V=M.isLoading,F=M.isSuccess;(0,r.useEffect)((function(){var e,t=new URLSearchParams(window.location.search).get("id");(null!==t&&D(t),a&&I)&&L(null===I||void 0===I||null===(e=I.data)||void 0===e?void 0:e.find((function(e){return e.id===a})))}),[a,I]);var Y=(0,h.cI)({mode:"onChange",defaultValues:C,resolver:(0,x.X)(m.Ry({startDate:m.hT().required(w("start date is required")),endDate:m.hT().required(w("end date is required")).min(m.iH("startDate"),w("end date can't be before start date")),duration:m.Rx().required(w("duration date is required")).min(1,w("duration min 1")),subject:m.Z_().required(w("subject is required")),reason:m.Z_().required(w("reason is required"))}))}),P=Y.control,R=Y.handleSubmit,U=Y.reset,_=(Y.watch,Y.setValue,Y.formState.errors);(0,r.useEffect)((function(){C&&U(C)}),[C]);return(0,r.useEffect)((function(){(k||F)&&q("/leave")}),[k,F]),(0,b.jsx)(j.Z,{children:(0,b.jsx)(u.Z,{children:(0,b.jsx)(d.Z,{children:(0,b.jsx)(d.Z.Body,{children:(0,b.jsxs)(i.Z,{children:[(0,b.jsx)("h5",{children:w("".concat(a?"update leave":"save leave"))}),(0,b.jsx)("hr",{className:"bg-light"}),(0,b.jsx)(o.Z,{children:(0,b.jsxs)(l.Z,{onSubmit:R((function(e){var t={startDate:e.startDate,endDate:e.endDate,duration:e.duration,subject:e.subject,reason:e.reason};a?G({id:a,postBody:t}):N(t)})),onReset:U,children:[(0,b.jsxs)(i.Z,{class:!0,children:[(0,b.jsx)(o.Z,{sm:4,children:(0,b.jsxs)(l.Z.Group,{className:"mb-3",controlId:"startDate",children:[(0,b.jsx)(l.Z.Label,{children:w("start date")}),(0,b.jsx)(h.Qr,{control:P,name:"startDate",render:function(e){var t=e.field,a=t.onChange,n=(t.onBlur,t.value),r=t.ref;return(0,b.jsx)(l.Z.Control,{onChange:a,defaultValue:n,ref:r,isInvalid:_.startDate,type:"date",size:"sm"})}}),_.startDate&&(0,b.jsx)(l.Z.Text,{className:"text-danger",children:_.startDate.message})]})}),(0,b.jsx)(o.Z,{sm:4,children:(0,b.jsxs)(l.Z.Group,{className:"mb-3",controlId:"endDate",children:[(0,b.jsx)(l.Z.Label,{children:w("end date")}),(0,b.jsx)(h.Qr,{control:P,name:"endDate",render:function(e){var t=e.field,a=t.onChange,n=(t.onBlur,t.value),r=t.ref;return(0,b.jsx)(l.Z.Control,{onChange:a,defaultValue:n,ref:r,isInvalid:_.endDate,type:"date",size:"sm"})}}),_.endDate&&(0,b.jsx)(l.Z.Text,{className:"text-danger",children:_.endDate.message})]})}),(0,b.jsx)(o.Z,{sm:4,children:(0,b.jsxs)(l.Z.Group,{className:"mb-3",controlId:"duration",children:[(0,b.jsx)(l.Z.Label,{children:w("duration")}),(0,b.jsx)(h.Qr,{control:P,name:"duration",render:function(e){var t=e.field,a=t.onChange,n=(t.onBlur,t.value),r=t.ref;return(0,b.jsx)(l.Z.Control,{onChange:a,defaultValue:n,ref:r,isInvalid:_.duration,placeholder:w("duration of the Leave"),type:"number",min:"1",size:"sm"})}}),_.duration&&(0,b.jsx)(l.Z.Text,{className:"text-danger",children:_.duration.message})]})}),(0,b.jsx)(o.Z,{sm:12,children:(0,b.jsxs)(l.Z.Group,{className:"mb-3",controlId:"subject",children:[(0,b.jsx)(l.Z.Label,{children:w("subject")}),(0,b.jsx)(h.Qr,{control:P,name:"subject",render:function(e){var t=e.field,a=t.onChange,n=(t.onBlur,t.value),r=t.ref;return(0,b.jsx)(l.Z.Control,{onChange:a,defaultValue:n,ref:r,isInvalid:_.subject,placeholder:w("subject of the leave"),type:"text",size:"sm"})}}),_.subject&&(0,b.jsx)(l.Z.Text,{className:"text-danger",children:_.subject.message})]})}),(0,b.jsx)(o.Z,{sm:12,children:(0,b.jsxs)(l.Z.Group,{className:"mb-3",controlId:"reason",children:[(0,b.jsx)(l.Z.Label,{children:w("reason")}),(0,b.jsx)(h.Qr,{control:P,name:"reason",render:function(e){var t=e.field,a=t.onChange,n=(t.onBlur,t.value),r=t.ref;return(0,b.jsx)(l.Z.Control,{onChange:a,defaultValue:n,ref:r,isInvalid:_.reason,placeholder:w("reason of the leave"),type:"text",size:"sm",as:"textarea"})}}),_.reason&&(0,b.jsx)(l.Z.Text,{className:"text-danger",children:_.reason.message})]})})]}),(0,b.jsx)(i.Z,{children:(0,b.jsx)(o.Z,{sm:4,children:(0,b.jsx)(c.Z,{size:"sm",className:"mt-2",type:"submit",children:T||V?(0,b.jsx)(v.Z,{size:"sm",color:"light"}):w("save change")})})})]})})]})})})})})}},1239:function(e,t,a){a.d(t,{p6:function(){return u}});a(2791);var n=a(6431),r=a.n(n),s=a(184);function u(e){var t=new Date(e),a=""+(t.getMonth()+1),n=""+t.getDate(),r=t.getFullYear();return a.length<2&&(a="0"+a),n.length<2&&(n="0"+n),[r,a,n].join("-")}t.ZP=function(e){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r(),{format:"D MMM YYYY",withTitle:!0,children:e})," ",(0,s.jsx)("br",{})]})}}}]);
//# sourceMappingURL=7414.ee840104.chunk.js.map